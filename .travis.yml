language: go
go:
  - 1.10.x

before_install:
  # for g++5 and C++11
  - sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test

  # Set up go-ethereum
  - sudo apt-get update -y -qq
  - sudo apt-get install -yqq libgmp3-dev 
  - git clone --depth=10 https://github.com/ethereum/go-ethereum ${GOPATH}/src/github.com/ethereum/go-ethereum
  # use canned dependencies from the go-ethereum repository
  - export GOPATH=$GOPATH:$GOPATH/src/github.com/ethereum/go-ethereum/Godeps/_workspace/
  - echo $GOPATH

install:
  # need to explicitly request version 1.55 since by default we get 1.46 which does not work with C++11
  - sudo apt-get install -qq --yes --force-yes g++-5
  - sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-5 50
  - sudo apt-get install -qq wget cmake bash libboost-test1.55-dev libboost-system1.55-dev libboost-filesystem1.55-dev nodejs python-pip python-dev valgrind
  - sudo pip install virtualenv -q
script: "./test/test.sh"
